<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <title>Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="/tpl/js/editor/editor.js"></script>
    <script src="/tpl/js/editor/editor-caption.js"></script>
    <link href="/tpl/css/editor/editor-caption.css" rel="stylesheet" />

</head>
<body>

    <div id="editorjs"></div>

    <button id="save-button">Save</button>
    <pre id="output"></pre>

</body>

<script>

    function jsonToHtml(articleObj) {
        var articleHTML = "";
        articleObj.map(obj => {
            switch (obj.type) {
                case 'caption':
                    articleHTML += `<h1 class="post_caption"> ${obj.data}  </h1>`
                    break;
                case 'paragraph':
                    // console.log("obj.type = " + obj.type);
                    articleHTML += `<p class="post_caption"> ${obj.data.text}  </p>`
                    break; 
                default:
                    return '';
            }
            console.log(articleHTML);
        });
        return articleHTML;
    }

    const editor = new EditorJS({
        autofocus: true,
        tools: {
            caption: Caption,
            paragraph: {
                config: {
                    placeholder: 'Нажмите Tab для выбора инструмента',
                }
            }
        },
        data: {
            time: 1552744582955,
            blocks: [
                {
                    type: "caption",
                    data: {
                        value: "Тестовый заголовок"
                    }
                },
                {
                    "type": "paragraph",
                    "data": {
                        "text": "Тестовый Параграф",
                    }
                },
            ],
        },
        onChange: () => {
            var titleCaption = document.querySelector('.ce-maintitle');
            if (!titleCaption) {
                editor.blocks.insert('caption', {
                    value: ""
                }, {}, 0, true);
            }
        }
    });
    const saveButton = document.getElementById('save-button');
    const output = document.getElementById('output');

    saveButton.addEventListener('click', () => {
        editor.save().then(savedData => {
            preview = JSON.stringify(savedData, null, 4);
            output.innerHTML = preview;
            console.log(preview);
        });
    })


    // this.api.blocks.render({
    //         blocks: [
    //             {
    //                 type: "caption",
    //                 data: {
    //                     value: "Тестовый заголовок"
    //                 }
    //             },
    //             {
    //                 "type": "paragraph",
    //                 "data": {
    //                     "text": "Тестовый Параграф",
    //                 }
    //             },
    //         ]
    //     });
</script>

</html>